---
layout: post
title:  "[js] 소요시간 측정"
date:   2019-01-31 00:10
categories: vanillaJS
tags: [js]
---
js 속도 튜닝이 필요할 경우 특별히 스크립트의 소요시간을 체크하고자 할 때 간단하게 사용할 수 있는 함수를 소개한다.

#### 사용법
```javascript
const timelog = require("./timelog")

timelog.start("sample task");

setTimeout(() => {
    timelog.check("1st 작업")
}, 200)

setTimeout(() => {
    timelog.check("2nd 작업")
}, 500)

setTimeout(() => {
    timelog.check("3rd 작업")
}, 900)
```

<br>

#### 실행 결과 
```
[timelog] (sample task) start: Thu Jan 31 2019 16:09:12
[timelog] (1st 작업) +206ms / +206ms
[timelog] (2nd 작업) +301ms / +507ms
[timelog] (3rd 작업) +399ms / +906ms
```

<br>

#### timelog.js
```javascript
const wrapWith = function (deco) {
    return function (str) {
        if (str) {
            return deco[0] + str + deco[1];
        } else {
            return "";
        }
    }
}
const round_brackets = wrapWith("()");

const timelog = (function () {
    const prefix = "[timelog]"
    let time = [];
    let o = {
        start: function (str) {
            time = [Date.now()];
            console.log(`${prefix} ${round_brackets(str)} start: ` + new Date(time[0]).toString().substr(0, 24))
        },
        check: function (str) {
            time.push(Date.now())
            let diff = time[time.length - 1] - time[time.length - 2];
            let total = time[time.length - 1] - time[0];
            console.log(`${prefix} ${round_brackets(str)} +${diff}ms / +${total}ms`);
            return diff;
        }
    };
    return o;
})();

module.exports = timelog;
```
